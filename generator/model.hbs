/**
 * @fileoverview Unified {{> entityLower}} model
 */

//Imports
import Joi from 'joi';
import {model as createModel, Document} from 'mongoose';
import joigoose from '../lib/joigoose';

//TypeScript interface
interface Interface extends Document
{
{{#each (uniqueFields)}}
  /**
   * {{{description}}}
   */
  {{name}}: {{{typescriptType}}};
{{#unless @last}}

{{/unless}}
{{/each}}
}

//Joi schema
const joiSchema = Joi.object({
{{#each (uniqueFields)}}
  {{name}}: {{{joiType}}}{{#unless @last}},{{/unless}}
{{/each}}
});

//Mongoose schema
const mongooseSchema = joigoose.convert(joiSchema);

//Mongoose model
const model = createModel<Interface>('{{> entityObject}}', mongooseSchema);

//Export
export {
  Interface as I{{> entityClass}},
  joiSchema as {{> entityClass}}Schema,
  model as {{> entityClass}}
};